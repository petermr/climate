<?xml version="1.0" encoding="UTF-8"?>
<p id="Par34">Separate analyses were conducted for the PRCS and PRC datasets and, within each of them, for temperature and precipitation. All analyses were conducted using linear models as no deviation from linearity was detected by visual inspection of the relations between (1) year and climate, (2) trait and climate and (3) selection and year for each study (Supplementary Figs. 
 <xref rid="MOESM1" ref-type="media">11</xref>–
 <xref rid="MOESM1" ref-type="media">15</xref>). First, we assessed for each study condition 1 necessary to infer adaptive responses (i.e. the extent to which the climatic variable changed directionally over years). To this end, we fitted for each study a mixed-effects model with the climatic variable as the response and the year as a fixed covariate, taking into account temporal autocorrelation (as random effect):
 <disp-formula id="Equ1">
  <label>1</label>
  <alternatives>
   <tex-math id="M1">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\mathrm{Clim}}_t = \alpha + \beta _{{\mathrm{Clim}}} \times {\mathrm{Year}}_t + \varepsilon _t + \varepsilon ,$$\end{document}</tex-math>
   <math id="M2">
    <msub>
     <mrow>
      <mi mathvariant="normal">Clim</mi>
     </mrow>
     <mrow>
      <mi>t</mi>
     </mrow>
    </msub>
    <mo>=</mo>
    <mi>α</mi>
    <mo>+</mo>
    <msub>
     <mrow>
      <mi>β</mi>
     </mrow>
     <mrow>
      <mi mathvariant="normal">Clim</mi>
     </mrow>
    </msub>
    <mo>×</mo>
    <msub>
     <mrow>
      <mi mathvariant="normal">Year</mi>
     </mrow>
     <mrow>
      <mi>t</mi>
     </mrow>
    </msub>
    <mo>+</mo>
    <msub>
     <mrow>
      <mi>ε</mi>
     </mrow>
     <mrow>
      <mi>t</mi>
     </mrow>
    </msub>
    <mo>+</mo>
    <mi>ε</mi>
    <mo>,</mo>
   </math>
   <graphic xlink:href="41467_2019_10924_Article_Equ1.gif" position="anchor" xmlns:xlink="http://www.w3.org/1999/xlink"/>
  </alternatives>
 </disp-formula>where Clim is the quantitative climate variable, Year the quantitative year covariate, 
 <italic>t</italic> the time, 
 <italic>ε</italic>
 <sub>
  <italic>t</italic>
 </sub> is a Gaussian random variable with mean zero and following an AR1 model over years, and 
 <italic>ε</italic> is an independent Gaussian random variable with mean zero and variance representing the residual variance of the study. 
 <italic>β</italic>
 <sub>Clim</sub> is the regression coefficient reflecting the slope of the climatic variable on the year for the study (Fig. 
 <xref rid="Fig1" ref-type="fig">1b</xref>). To avoid overfitting, we refitted the same model without the AR1 structure and retained, for each study, the model structure leading to the lowest marginal AIC
 <sup>
  <xref ref-type="bibr" rid="CR62">62</xref>
 </sup>. This approach was applied to all the models fitted to each study (i.e. to assess conditions 2 and 3, and change of selection across years, as described below).
</p>
