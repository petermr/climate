<?xml version="1.0" encoding="UTF-8"?>
<p id="Par23">By allowing the weight 
 <italic>w</italic> to depend on the frequency of cooperators, we can derive the optimal switching point 
 <italic>s</italic>* between positive and negative incentives by minimizing the defector’s advantage (
 <italic>f</italic>
 <sub>D</sub> − 
 <italic>f</italic>
 <sub>C</sub>). This is done similarly to ref.
 <sup>
  <xref ref-type="bibr" rid="CR12">12</xref>
 </sup>, but using finite populations and therefore a hypergeometric distribution (see Eqs (
 <xref rid="Equ1" ref-type="">1</xref>), (
 <xref rid="Equ2" ref-type="">2</xref>), (
 <xref rid="Equ5" ref-type="">5</xref>), and (
 <xref rid="Equ6" ref-type="">6</xref>)), to account for sampling without replacement. From Eqs (
 <xref rid="Equ1" ref-type="">1</xref>) and (
 <xref rid="Equ2" ref-type="">2</xref>), we get
 <disp-formula id="Equa">
  <alternatives>
   <tex-math id="M53">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$$\begin{array}{rcl}{f}_{D} &amp; = &amp; \mathop{\sum }\limits_{j=0}^{N-1}\frac{(\begin{array}{c}\,k\\ j\end{array})(\begin{array}{c}Z-1-k\\ N-1-j\end{array})}{(\begin{array}{c}Z-1\\ N-1\end{array})}({\Pi }_{D}(j)-\frac{b(1-w)N\delta }{N-j})\\ {f}_{C} &amp; = &amp; \mathop{\sum }\limits_{j=0}^{N-1}\frac{(\begin{array}{c}k-1\\ j\end{array})(\begin{array}{c}Z-1-(k-1)\\ N-1-j\end{array})}{(\begin{array}{c}Z-1\\ N-1\end{array})}({\Pi }_{C}(j+1)-c+\frac{awN\delta }{j+1})\end{array}$$\end{document}</tex-math>
   <math id="M54" display="block">
    <mtable columnalign="left">
     <mtr columnalign="left">
      <mtd columnalign="right">
       <mrow>
        <msub>
         <mrow>
          <mi>f</mi>
         </mrow>
         <mrow>
          <mi>D</mi>
         </mrow>
        </msub>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mo>=</mo>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <munderover>
         <mo>∑</mo>
         <mrow>
          <mi>j</mi>
          <mo>=</mo>
          <mn>0</mn>
         </mrow>
         <mrow>
          <mi>N</mi>
          <mo>−</mo>
          <mn>1</mn>
         </mrow>
        </munderover>
        <mfrac>
         <mrow>
          <mrow>
           <mo stretchy="true">(</mo>
           <mrow>
            <mtable>
             <mtr>
              <mtd>
               <mrow>
                <mspace width=".25em"/>
                <mi>k</mi>
               </mrow>
              </mtd>
             </mtr>
             <mtr>
              <mtd>
               <mi>j</mi>
              </mtd>
             </mtr>
            </mtable>
           </mrow>
           <mo stretchy="true">)</mo>
          </mrow>
          <mrow>
           <mo stretchy="true">(</mo>
           <mrow>
            <mtable>
             <mtr>
              <mtd>
               <mrow>
                <mi>Z</mi>
                <mo>−</mo>
                <mn>1</mn>
                <mo>−</mo>
                <mi>k</mi>
               </mrow>
              </mtd>
             </mtr>
             <mtr>
              <mtd>
               <mrow>
                <mi>N</mi>
                <mo>−</mo>
                <mn>1</mn>
                <mo>−</mo>
                <mi>j</mi>
               </mrow>
              </mtd>
             </mtr>
            </mtable>
           </mrow>
           <mo stretchy="true">)</mo>
          </mrow>
         </mrow>
         <mrow>
          <mo stretchy="true">(</mo>
          <mrow>
           <mtable>
            <mtr>
             <mtd>
              <mrow>
               <mi>Z</mi>
               <mo>−</mo>
               <mn>1</mn>
              </mrow>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <mrow>
               <mi>N</mi>
               <mo>−</mo>
               <mn>1</mn>
              </mrow>
             </mtd>
            </mtr>
           </mtable>
          </mrow>
          <mo stretchy="true">)</mo>
         </mrow>
        </mfrac>
        <mrow>
         <mo stretchy="true">(</mo>
         <mrow>
          <msub>
           <mrow>
            <mi mathvariant="normal">Π</mi>
           </mrow>
           <mrow>
            <mi>D</mi>
           </mrow>
          </msub>
          <mrow>
           <mo stretchy="true">(</mo>
           <mi>j</mi>
           <mo stretchy="true">)</mo>
          </mrow>
          <mo>−</mo>
          <mfrac>
           <mrow>
            <mi>b</mi>
            <mrow>
             <mo stretchy="true">(</mo>
             <mrow>
              <mn>1</mn>
              <mo>−</mo>
              <mi>w</mi>
             </mrow>
             <mo stretchy="true">)</mo>
            </mrow>
            <mi>N</mi>
            <mi>δ</mi>
           </mrow>
           <mrow>
            <mi>N</mi>
            <mo>−</mo>
            <mi>j</mi>
           </mrow>
          </mfrac>
         </mrow>
         <mo stretchy="true">)</mo>
        </mrow>
       </mrow>
      </mtd>
     </mtr>
     <mtr columnalign="left">
      <mtd columnalign="right">
       <mrow>
        <msub>
         <mrow>
          <mi>f</mi>
         </mrow>
         <mrow>
          <mi>C</mi>
         </mrow>
        </msub>
       </mrow>
      </mtd>
      <mtd columnalign="center">
       <mo>=</mo>
      </mtd>
      <mtd columnalign="left">
       <mrow>
        <munderover>
         <mo>∑</mo>
         <mrow>
          <mi>j</mi>
          <mo>=</mo>
          <mn>0</mn>
         </mrow>
         <mrow>
          <mi>N</mi>
          <mo>−</mo>
          <mn>1</mn>
         </mrow>
        </munderover>
        <mfrac>
         <mrow>
          <mrow>
           <mo stretchy="true">(</mo>
           <mrow>
            <mtable>
             <mtr>
              <mtd>
               <mrow>
                <mi>k</mi>
                <mo>−</mo>
                <mn>1</mn>
               </mrow>
              </mtd>
             </mtr>
             <mtr>
              <mtd>
               <mi>j</mi>
              </mtd>
             </mtr>
            </mtable>
           </mrow>
           <mo stretchy="true">)</mo>
          </mrow>
          <mrow>
           <mo stretchy="true">(</mo>
           <mrow>
            <mtable>
             <mtr>
              <mtd>
               <mrow>
                <mi>Z</mi>
                <mo>−</mo>
                <mn>1</mn>
                <mo>−</mo>
                <mrow>
                 <mo stretchy="true">(</mo>
                 <mrow>
                  <mi>k</mi>
                  <mo>−</mo>
                  <mn>1</mn>
                 </mrow>
                 <mo stretchy="true">)</mo>
                </mrow>
               </mrow>
              </mtd>
             </mtr>
             <mtr>
              <mtd>
               <mrow>
                <mi>N</mi>
                <mo>−</mo>
                <mn>1</mn>
                <mo>−</mo>
                <mi>j</mi>
               </mrow>
              </mtd>
             </mtr>
            </mtable>
           </mrow>
           <mo stretchy="true">)</mo>
          </mrow>
         </mrow>
         <mrow>
          <mo stretchy="true">(</mo>
          <mrow>
           <mtable>
            <mtr>
             <mtd>
              <mrow>
               <mi>Z</mi>
               <mo>−</mo>
               <mn>1</mn>
              </mrow>
             </mtd>
            </mtr>
            <mtr>
             <mtd>
              <mrow>
               <mi>N</mi>
               <mo>−</mo>
               <mn>1</mn>
              </mrow>
             </mtd>
            </mtr>
           </mtable>
          </mrow>
          <mo stretchy="true">)</mo>
         </mrow>
        </mfrac>
        <mo stretchy="false">(</mo>
        <msub>
         <mrow>
          <mi mathvariant="normal">Π</mi>
         </mrow>
         <mrow>
          <mi>C</mi>
         </mrow>
        </msub>
        <mrow>
         <mo stretchy="true">(</mo>
         <mrow>
          <mi>j</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
         <mo stretchy="true">)</mo>
        </mrow>
        <mo>−</mo>
        <mi>c</mi>
        <mo>+</mo>
        <mfrac>
         <mrow>
          <mi>a</mi>
          <mi>w</mi>
          <mi>N</mi>
          <mi>δ</mi>
         </mrow>
         <mrow>
          <mi>j</mi>
          <mo>+</mo>
          <mn>1</mn>
         </mrow>
        </mfrac>
        <mo stretchy="false">)</mo>
       </mrow>
      </mtd>
     </mtr>
    </mtable>
   </math>
   <graphic xlink:href="41598_2019_52524_Article_Equa.gif" position="anchor" xmlns:xlink="http://www.w3.org/1999/xlink"/>
  </alternatives>
 </disp-formula>from which we aim at finding the value of 
 <italic>w</italic> (with respect to 
 <italic>k</italic>) that minimizes 
 <italic>F</italic>′ = 
 <italic>f</italic>
 <sub>D</sub> − 
 <italic>f</italic>
 <sub>C</sub>. Since 
 <inline-formula id="IEq19">
  <alternatives>
   <tex-math id="M55">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\Pi }_{D}(j)$$\end{document}</tex-math>
   <math id="M56">
    <msub>
     <mrow>
      <mi mathvariant="normal">Π</mi>
     </mrow>
     <mrow>
      <mi>D</mi>
     </mrow>
    </msub>
    <mo stretchy="false">(</mo>
    <mi>j</mi>
    <mo stretchy="false">)</mo>
   </math>
   <inline-graphic xlink:href="41598_2019_52524_Article_IEq19.gif" xmlns:xlink="http://www.w3.org/1999/xlink"/>
  </alternatives>
 </inline-formula>, 
 <inline-formula id="IEq20">
  <alternatives>
   <tex-math id="M57">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${\Pi }_{C}(j+1)$$\end{document}</tex-math>
   <math id="M58">
    <msub>
     <mrow>
      <mi mathvariant="normal">Π</mi>
     </mrow>
     <mrow>
      <mi>C</mi>
     </mrow>
    </msub>
    <mo stretchy="false">(</mo>
    <mi>j</mi>
    <mo>+</mo>
    <mn>1</mn>
    <mo stretchy="false">)</mo>
   </math>
   <inline-graphic xlink:href="41598_2019_52524_Article_IEq20.gif" xmlns:xlink="http://www.w3.org/1999/xlink"/>
  </alternatives>
 </inline-formula> and 
 <italic>c</italic> do not depend on 
 <italic>w</italic>, these quantities do not affect the choice of the optimal 
 <italic>w</italic>, leaving us with the problem of minimizing the following expression:
 <disp-formula id="Equb">
  <alternatives>
   <tex-math id="M59">\documentclass[12pt]{minimal} \usepackage{amsmath} \usepackage{wasysym} \usepackage{amsfonts} \usepackage{amssymb} \usepackage{amsbsy} \usepackage{mathrsfs} \usepackage{upgreek} \setlength{\oddsidemargin}{-69pt} \begin{document}$${F}^{\text{'}}=-\,N\delta \mathop{\sum }\limits_{j=0}^{N-1}\frac{(\begin{array}{c}k\\ j\end{array})(\begin{array}{c}Z-1-k\\ N-1-j\end{array})}{(\begin{array}{c}Z-1\\ N-1\end{array})}(\frac{b(1-w)}{N-j})-N\delta \mathop{\sum }\limits_{j=0}^{N-1}\frac{(\begin{array}{c}k-1\\ j\end{array})(\begin{array}{c}Z-k\\ N-1-j\end{array})}{(\begin{array}{c}Z-1\\ N-1\end{array})}(\frac{aw}{j+1})$$\end{document}</tex-math>
   <math id="M60" display="block">
    <msup>
     <mrow>
      <mi>F</mi>
     </mrow>
     <mo>'</mo>
    </msup>
    <mo>=</mo>
    <mo>−</mo>
    <mspace width="-.25em"/>
    <mi>N</mi>
    <mi>δ</mi>
    <munderover>
     <mo>∑</mo>
     <mrow>
      <mi>j</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mrow>
      <mi>N</mi>
      <mo>−</mo>
      <mn>1</mn>
     </mrow>
    </munderover>
    <mfrac>
     <mrow>
      <mrow>
       <mo stretchy="true">(</mo>
       <mrow>
        <mtable>
         <mtr>
          <mtd>
           <mi>k</mi>
          </mtd>
         </mtr>
         <mtr>
          <mtd>
           <mi>j</mi>
          </mtd>
         </mtr>
        </mtable>
       </mrow>
       <mo stretchy="true">)</mo>
      </mrow>
      <mrow>
       <mo stretchy="true">(</mo>
       <mrow>
        <mtable>
         <mtr>
          <mtd>
           <mrow>
            <mi>Z</mi>
            <mo>−</mo>
            <mn>1</mn>
            <mo>−</mo>
            <mi>k</mi>
           </mrow>
          </mtd>
         </mtr>
         <mtr>
          <mtd>
           <mrow>
            <mi>N</mi>
            <mo>−</mo>
            <mn>1</mn>
            <mo>−</mo>
            <mi>j</mi>
           </mrow>
          </mtd>
         </mtr>
        </mtable>
       </mrow>
       <mo stretchy="true">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo stretchy="true">(</mo>
      <mrow>
       <mtable>
        <mtr>
         <mtd>
          <mrow>
           <mi>Z</mi>
           <mo>−</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
        </mtr>
        <mtr>
         <mtd>
          <mrow>
           <mi>N</mi>
           <mo>−</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
        </mtr>
       </mtable>
      </mrow>
      <mo stretchy="true">)</mo>
     </mrow>
    </mfrac>
    <mrow>
     <mo stretchy="true">(</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mi>b</mi>
        <mrow>
         <mo stretchy="true">(</mo>
         <mrow>
          <mn>1</mn>
          <mo>−</mo>
          <mi>w</mi>
         </mrow>
         <mo stretchy="true">)</mo>
        </mrow>
       </mrow>
       <mrow>
        <mi>N</mi>
        <mo>−</mo>
        <mi>j</mi>
       </mrow>
      </mfrac>
     </mrow>
     <mo stretchy="true">)</mo>
    </mrow>
    <mo>−</mo>
    <mi>N</mi>
    <mi>δ</mi>
    <munderover>
     <mo>∑</mo>
     <mrow>
      <mi>j</mi>
      <mo>=</mo>
      <mn>0</mn>
     </mrow>
     <mrow>
      <mi>N</mi>
      <mo>−</mo>
      <mn>1</mn>
     </mrow>
    </munderover>
    <mfrac>
     <mrow>
      <mrow>
       <mo stretchy="true">(</mo>
       <mrow>
        <mtable>
         <mtr>
          <mtd>
           <mrow>
            <mi>k</mi>
            <mo>−</mo>
            <mn>1</mn>
           </mrow>
          </mtd>
         </mtr>
         <mtr>
          <mtd>
           <mi>j</mi>
          </mtd>
         </mtr>
        </mtable>
       </mrow>
       <mo stretchy="true">)</mo>
      </mrow>
      <mrow>
       <mo stretchy="true">(</mo>
       <mrow>
        <mtable>
         <mtr>
          <mtd>
           <mrow>
            <mi>Z</mi>
            <mo>−</mo>
            <mi>k</mi>
           </mrow>
          </mtd>
         </mtr>
         <mtr>
          <mtd>
           <mrow>
            <mi>N</mi>
            <mo>−</mo>
            <mn>1</mn>
            <mo>−</mo>
            <mi>j</mi>
           </mrow>
          </mtd>
         </mtr>
        </mtable>
       </mrow>
       <mo stretchy="true">)</mo>
      </mrow>
     </mrow>
     <mrow>
      <mo stretchy="true">(</mo>
      <mrow>
       <mtable>
        <mtr>
         <mtd>
          <mrow>
           <mi>Z</mi>
           <mo>−</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
        </mtr>
        <mtr>
         <mtd>
          <mrow>
           <mi>N</mi>
           <mo>−</mo>
           <mn>1</mn>
          </mrow>
         </mtd>
        </mtr>
       </mtable>
      </mrow>
      <mo stretchy="true">)</mo>
     </mrow>
    </mfrac>
    <mrow>
     <mo stretchy="true">(</mo>
     <mrow>
      <mfrac>
       <mrow>
        <mi>a</mi>
        <mi>w</mi>
       </mrow>
       <mrow>
        <mi>j</mi>
        <mo>+</mo>
        <mn>1</mn>
       </mrow>
      </mfrac>
     </mrow>
     <mo stretchy="true">)</mo>
    </mrow>
   </math>
   <graphic xlink:href="41598_2019_52524_Article_Equb.gif" position="anchor" xmlns:xlink="http://www.w3.org/1999/xlink"/>
  </alternatives>
 </disp-formula>
</p>
