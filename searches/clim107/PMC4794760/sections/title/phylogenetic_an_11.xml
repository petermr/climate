<?xml version="1.0" encoding="UTF-8"?>
<sec disp-level="3" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">Phylogenetic analyses</div>
 <p xmlns="http://www.w3.org/1999/xhtml">We aligned length variable (i.e. ribosomal) sequences with MAFFT v. 7 and the Q-INS-i algorithm, which considers the secondary structure
  <a ref-type="bibr" rid="b45" href="#b45">45</a>. To obtain an ultrametric tree we used BEAST v.1.7
  <a ref-type="bibr" rid="b46" href="#b46">46</a> with an uncorrelated lognormal clock and a Yule speciation process. We linked the evolutionary rates of the mitochondrial protein coding genes and the two nuclear ribosomal genes respectively to reduce the number of free parameters, and used a GTR + I + G model with unlinked parameters for each partition. Trees were rooted in the node separating a clade with 1 instar larval development from a clade with either 2- or 1-instar, according to the topology of a previous study
  <a ref-type="bibr" rid="b39" href="#b39">39</a> (
  <a ref-type="supplementary-material" rid="S1" href="#S1">Supplementary Fig. S2</a>). For the calibration we used the estimates obtained in this same study, that were based on the tectonic separation of the Sardinian plate, 16.6 Ma for the clade of species with a 1-instar cycle and 13.7 Ma for the clade of uncertain life cycle type. Both were set up as priors with a normal distribution with the estimated age as mean and a standard deviation of 1 MY.
 </p>
 <p xmlns="http://www.w3.org/1999/xhtml">For the estimation of the minimum accumulated change in temperature experienced through the evolutionary history of the lineage, we used ancestral trait reconstruction in BEAST, using as a quantitative trait the temperature of the cave in which each specimen was found (either directly measured or inferred from the annual average temperature of the locality; see 
  <a ref-type="supplementary-material" rid="S1" href="#S1">Supplementary Tables S2</a> and 
  <a ref-type="supplementary-material" rid="S1" href="#S1">S3</a>), and a multivariate diffusion model of evolution. We used three different measures: current temperature, the estimated LGM temperature, and the difference between the two (“range”) (see below). Analyses were run for 60 million generations, with a conservative burn-in of 10 millions. In all Bayesian analyses convergence was assessed with the effective sample size in TRACER 1.5. This reconstruction can be interpreted as the minimum amount of change in the thermal niche that the species should have experienced through their evolutionary history given the observed differences between species and the reconstructed topology.
 </p>
</sec>
