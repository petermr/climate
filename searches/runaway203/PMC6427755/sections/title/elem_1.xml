<?xml version="1.0" encoding="UTF-8"?>
<sec sec-type="methods" id="sec2-sensors-19-01118" class="sec">
 <div class="title" xmlns="http://www.w3.org/1999/xhtml">2. Data and Methodology</div>
 <sec id="sec2dot1-sensors-19-01118" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">2.1. XCO
   <sub>2</sub> Retrievals and Mapping XCO
   <sub>2</sub> Dataset
  </div>
  <p xmlns="http://www.w3.org/1999/xhtml">XCO
   <sub>2</sub> retrieval data products from January 2010 to December 2015 are collected from GOSAT Atmospheric CO
   <sub>2</sub> Observations from Space (ACOS v7.3). This dataset was produced by the Orbiting Carbon Observatory (OCO) team of the US National Aeronautics and Space Administration (NASA) using a full physics algorithm to retrieve XCO
   <sub>2</sub> from GOSAT’s Spectrometer (TANSO-FTS) calibrated spectra measurements (Level 1B) [
   <a rid="B19-sensors-19-01118" ref-type="bibr" href="#B19-sensors-19-01118">19</a>]. In order to ensure high reliability of the data, only those data over land with high gain are used after screening and correction of systematic bias as described in the ACOS Level 2 Standard Product and Lite Data Product Data User’s Guide, v7.3 [
   <a rid="B20-sensors-19-01118" ref-type="bibr" href="#B20-sensors-19-01118">20</a>]. ACOS XCO
   <sub>2</sub> retrievals have a standard deviation of error of 1.48 ppm when comparing with ground-based measures of Total Carbon Column Observing Network (TCCON) [
   <a rid="B21-sensors-19-01118" ref-type="bibr" href="#B21-sensors-19-01118">21</a>]. 
   <a ref-type="fig" rid="sensors-19-01118-f001" href="#sensors-19-01118-f001">Figure 1</a> shows the total counts of XCO
   <sub>2</sub> data points during 6 years from January 2010 to December 2015, and their temporal variation in the study area. An annual increase of XCO
   <sub>2</sub> and the seasonal variation can be clearly seen. 
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">However, XCO
   <sub>2</sub> data are irregularly distributed and have many gaps in space and time as shown in 
   <a ref-type="fig" rid="sensors-19-01118-f001" href="#sensors-19-01118-f001">Figure 1</a>a because of the limitation of GOSAT observation mode, cloudy and data screening. To investigate the space-time changes of XCO
   <sub>2</sub>, we generate a mapping XCO
   <sub>2</sub> dataset in which those gaps are filled using the kriging interpolation method based on the spatio-temporal geo-statistics model [
   <a rid="B22-sensors-19-01118" ref-type="bibr" href="#B22-sensors-19-01118">22</a>,
   <a rid="B23-sensors-19-01118" ref-type="bibr" href="#B23-sensors-19-01118">23</a>,
   <a rid="B24-sensors-19-01118" ref-type="bibr" href="#B24-sensors-19-01118">24</a>]. The mapping XCO
   <sub>2</sub> dataset is generated mainly in Chinese mainland area from 18° N to 57° N and from 65° E to 148° E with 0.5° × 0.5° grid cells and 3-day interval in time from 1 January 2010 to 31 December 2015. In order to match with collected ODIAC emission dataset in 1° × 1°, we resampled the spatial resolution of data we used in this paper to 1° × 1°. This mapping dataset is hereafter referred to as Mapping-XCO
   <sub>2</sub>.
  </p>
 </sec>
 <sec id="sec2dot2-sensors-19-01118" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">2.2. Anthropogenic Emission Data</div>
  <p xmlns="http://www.w3.org/1999/xhtml">We collected two datasets of the bottom-up anthropogenic CO
   <sub>2</sub> emissions. One is the Open-source Data Inventory for Anthropogenic Carbon dioxide (ODIAC) for same years as the used XCO
   <sub>2</sub> dataset in this study. The other is the CARbon Monitoring for Action (CARMA) power plant database in 2009. The specifications of these data are described in 
   <a rid="sensors-19-01118-t001" ref-type="table" href="#sensors-19-01118-t001">Table 1</a>.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">The ODIAC emissions data product is a global 1° × 1° gridded monthly fossil fuel CO
   <sub>2</sub> emission inventory, developed based on country level fossil fuel CO
   <sub>2</sub> emission estimates, fuel consumption statistics, satellite-observed nightlight data, and point source information (geographical locations and emission intensities) from the CARbon Monitoring for Action (CARMA) power plant database (ODIAC2015a, available at 
   <span xlink:href="http://db.cger.nies.go.jp/dataset/ODIAC/" class="uri" xmlns:xlink="http://www.w3.org/1999/xlink">http://db.cger.nies.go.jp/dataset/ODIAC/</span>). The global nightlight data were used as a geo-referenced, spatial proxy to determine the spatial extent of anthropogenic emissions from line and diffused (area) sources (e.g., road traffic, residential or commercial fuel consumption) [
   <a rid="B25-sensors-19-01118" ref-type="bibr" href="#B25-sensors-19-01118">25</a>]. The ODIAC gridded emissions fields defined on a global rectangular (latitude ×longitude) coordinate are remapped to meet the grids resolutions for each simulation domain.
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">Additionally, the CO2 emissions from power plant, which is one of the dominant CO
   <sub>2</sub> emitting sources, are collected in the study area from the database of Carbon Monitoring for Action (CARMA, available at 
   <span xlink:href="http://carma.org/plant" class="uri" xmlns:xlink="http://www.w3.org/1999/xlink">http://carma.org/plant</span>). At the same time, we unify the units of the two sets of emission data to ton, and take the logarithm of two emission data base on 10 (refer to as lgE) to facilitate the calculation.
  </p>
 </sec>
 <sec id="sec2dot3-sensors-19-01118" sec-type="methods" class="sec">
  <div class="title" xmlns="http://www.w3.org/1999/xhtml">2.3. Methodology</div>
  <p xmlns="http://www.w3.org/1999/xhtml">The method for estimating anthropogenic CO
   <sub>2</sub> emission include three major steps as shown in 
   <a ref-type="fig" rid="sensors-19-01118-f002" href="#sensors-19-01118-f002">Figure 2</a>. 
  </p>
  <p xmlns="http://www.w3.org/1999/xhtml">Firstly, we enhance the signals of CO
   <sub>2</sub> from anthropogenic emission in XCO
   <sub>2</sub> which is described in 
   <a ref-type="sec" rid="sec2dot3dot1-sensors-19-01118" href="#sec2dot3dot1-sensors-19-01118">Section 2.3.1</a>. Secondly, we apply the training datasets of XCO
   <sub>2</sub> and ODIAC in 2010–2014 to GRNN to get the estimating model of anthropogenic emission which is described in 
   <a ref-type="sec" rid="sec2dot3dot2-sensors-19-01118" href="#sec2dot3dot2-sensors-19-01118">Section 2.3.2</a> in detail. Thirdly, anthropogenic emissions are estimated by GRNN model using XCO
   <sub>2</sub> in 2015, and validated by comparing with ODIAC data in 2015.
  </p>
  <sec id="sec2dot3dot1-sensors-19-01118" class="sec">
   <div class="title" xmlns="http://www.w3.org/1999/xhtml">2.3.1. Variable of XCO
    <sub>2</sub> Used for Estimation of Anthropogenic Emission
   </div>
   <p xmlns="http://www.w3.org/1999/xhtml">The magnitude of XCO
    <sub>2</sub> include CO
    <sub>2</sub> emitted by anthropogenic activities, the fluxes of terrestrial biosphere, fluxes transported by atmospheric wind fields [
    <a rid="B27-sensors-19-01118" ref-type="bibr" href="#B27-sensors-19-01118">27</a>,
    <a rid="B28-sensors-19-01118" ref-type="bibr" href="#B28-sensors-19-01118">28</a>] and CO
    <sub>2</sub> of regional background. We introduce therefrom an interannual variability by removing the regional background signal and calculating their annual mean to enhance the signals of CO
    <sub>2</sub> from anthropogenic emission as following equation proposed by Hakkarainen et al. [
    <a rid="B17-sensors-19-01118" ref-type="bibr" href="#B17-sensors-19-01118">17</a>]: 
    <div id="FD1-sensors-19-01118" class="disp-formula">
     <span class="label">(1)</span>
     <div id="mm1" class="math">
      <div class="mrow">
       <div class="mrow">
        <span class="mi">d</span>
        <span class="mi">X</span>
        <span class="mi">C</span>
        <div class="msub">
         <span class="mi">O</span>
         <span class="mn">2</span>
        </div>
        <div class="mrow">
         <span class="mo">(</span>
         <div class="mrow">
          <span class="mi">g</span>
          <span class="mi">r</span>
          <span class="mi">i</span>
          <span class="mi">d</span>
          <span class="mo">,</span>
          <span class="mi">t</span>
         </div>
         <span class="mo">)</span>
        </div>
        <span class="mo">=</span>
        <span class="mi">X</span>
        <span class="mi">C</span>
        <div class="msub">
         <span class="mi">O</span>
         <span class="mn">2</span>
        </div>
        <div class="mrow">
         <span class="mo">(</span>
         <div class="mrow">
          <span class="mi">g</span>
          <span class="mi">r</span>
          <span class="mi">i</span>
          <span class="mi">d</span>
          <span class="mo">,</span>
          <span class="mi">t</span>
         </div>
         <span class="mo">)</span>
        </div>
        <span class="mo">−</span>
        <span class="mi">M</span>
        <span class="mi">X</span>
        <span class="mi">C</span>
        <div class="msub">
         <span class="mi">O</span>
         <span class="mn">2</span>
        </div>
        <div class="mrow">
         <span class="mo">(</span>
         <span class="mi">t</span>
         <span class="mo">)</span>
        </div>
       </div>
      </div>
     </div>
    </div>where dXCO
    <sub>2</sub> (grid,t) indicates the deviation from regional background for each grid at a specific time unit t where t is the 3-day unit of used mapping-XCO
    <sub>2</sub> data; XCO
    <sub>2</sub> (grid,t) is XCO
    <sub>2</sub> for each grid at time t from mapping-XCO
    <sub>2</sub> data; MXCO
    <sub>2</sub>(t) is median of XCO
    <sub>2</sub> for all girds in the study region at time t calculated from mapping-XCO
    <sub>2</sub> data with 0.5° × 0.5° grid cell. Lastly we apply the annual mean of dXCO
    <sub>2</sub> (grid,t) for the year from 2010 to 2015 in the estimation of anthropogenic emission. This annual mean of dXCO
    <sub>2</sub> (grid,t) could detrend the seasonal variation at locale and simultaneously reduces the effect of the atmospheric transport [
    <a rid="B17-sensors-19-01118" ref-type="bibr" href="#B17-sensors-19-01118">17</a>].
   </p>
   <p xmlns="http://www.w3.org/1999/xhtml">We computed the monthly averaged dXCO
    <sub>2</sub> and annual averaged dXCO
    <sub>2</sub> for each grid to generate monthly averaged dXCO
    <sub>2</sub> dataset and annual averaged dXCO
    <sub>2</sub> dataset from the year 2010 to 2015 with 1° × 1° grids using the mapping XCO
    <sub>2</sub> dataset from 2010 to 2015. The annual dXCO
    <sub>2</sub> dataset and ODIAC data will be used in the following analysis.
   </p>
  </sec>
  <sec id="sec2dot3dot2-sensors-19-01118" class="sec">
   <div class="title" xmlns="http://www.w3.org/1999/xhtml">2.3.2. Estimation of Anthropogenic CO
    <sub>2</sub> Emission by Neural Network Development
   </div>
   <p xmlns="http://www.w3.org/1999/xhtml">Because XCO
    <sub>2</sub> variations are forced by anthropogenic emissions, exchange between the atmosphere and the ocean and the terrestrial biosphere [
    <a rid="B27-sensors-19-01118" ref-type="bibr" href="#B27-sensors-19-01118">27</a>,
    <a rid="B28-sensors-19-01118" ref-type="bibr" href="#B28-sensors-19-01118">28</a>], there are both non-linear and linear mapping between XCO
    <sub>2</sub> and emissions. Here we adopt a General Regression Neural Network (GRNN) algorithm [
    <a rid="B29-sensors-19-01118" ref-type="bibr" href="#B29-sensors-19-01118">29</a>] to represent non-linear mapping between the independent variables (dXCO
    <sub>2</sub> in this study) and dependent variable (CO
    <sub>2</sub> emissions in this study). GRNN directly draws the function estimate approximating any arbitrary function between the input and output vectors of variables. The GRNN converges to the optimal regression result when the training samples increases in number, meanwhile, the error of estimation is closed to 0. There are four layers in the GRNN model we used, an input layer, a hidden layer, a summation layer, and a decision layer (
    <a ref-type="fig" rid="sensors-19-01118-f003" href="#sensors-19-01118-f003">Figure 3</a>; [
    <a rid="B30-sensors-19-01118" ref-type="bibr" href="#B30-sensors-19-01118">30</a>,
    <a rid="B31-sensors-19-01118" ref-type="bibr" href="#B31-sensors-19-01118">31</a>]). In the input layer, each neuron corresponds to an independent variable which is defined as a mathematical function, the independent variable values will be standardized. Then the standardized independent variable values were transferred to the neurons in the hidden layer. In this layer, each neurons stores the values of the independent variables and the dependent variable, and a scalar function will be calculated. There are two neurons in the summation layer, the denominator summation unit sums the weight values coming from the hidden neurons, and the numerator summation unit sums the weight values multiplied by the actual target dependent variable value for each hidden neuron. At last, dividing the value accumulated in the numerator summation unit by the value in the denominator summation unit in the decision layer, we uses the division result as the predicted target dependent variable value [
    <a rid="B32-sensors-19-01118" ref-type="bibr" href="#B32-sensors-19-01118">32</a>].
   </p>
   <p xmlns="http://www.w3.org/1999/xhtml">According to the calculation steps of developing a neural network, we need to standardize all the independent and dependent training variables, so that in the input layer all training data will have the same order of magnitudes. 
    <div id="FD2-sensors-19-01118" class="disp-formula">
     <span class="label">(2)</span>
     <div id="mm2" class="math">
      <div class="mrow">
       <div class="mrow">
        <span class="mi">d</span>
        <div class="mrow">
         <span class="mo">(</span>
         <div class="mrow">
          <div class="msub">
           <span class="mi">x</span>
           <span class="mn">0</span>
          </div>
          <span class="mo">−</span>
          <div class="msub">
           <span class="mi">x</span>
           <span class="mi">i</span>
          </div>
         </div>
         <span class="mo">)</span>
        </div>
        <span class="mo">=</span>
        <div class="munderover">
         <div mathsize="140%" displaystyle="true" class="mstyle">
          <span class="mo">∑</span>
         </div>
         <div class="mrow">
          <span class="mi">j</span>
          <span class="mo">=</span>
          <span class="mn">1</span>
         </div>
         <span class="mi">p</span>
        </div>
        <div class="msup">
         <div class="mrow">
          <div class="mrow">
           <span class="mo">[</span>
           <div class="mrow">
            <div class="mfrac">
             <div class="mrow">
              <div class="msub">
               <span class="mi">x</span>
               <div class="mrow">
                <span class="mn">0</span>
                <span class="mi">j</span>
               </div>
              </div>
              <span class="mo">−</span>
              <div class="msub">
               <span class="mi">x</span>
               <div class="mrow">
                <span class="mi">i</span>
                <span class="mi">j</span>
               </div>
              </div>
             </div>
             <span class="mi">σ</span>
            </div>
           </div>
           <span class="mo">]</span>
          </div>
         </div>
         <span class="mn">2</span>
        </div>
       </div>
      </div>
     </div>
    </div>where 
    <div class="inline-formula">
     <div id="mm3" class="math">
      <div class="mrow">
       <span class="mi">p</span>
      </div>
     </div>
    </div> denotes the dimension of variable vector 
    <div class="inline-formula">
     <div id="mm4" class="math">
      <div class="mrow">
       <div class="mrow">
        <div class="msub">
         <span class="mi">x</span>
         <span class="mi">i</span>
        </div>
       </div>
      </div>
     </div>
    </div>, 
    <div class="inline-formula">
     <div id="mm5" class="math">
      <div class="mrow">
       <div class="mrow">
        <span class="mi">σ</span>
       </div>
      </div>
     </div>
    </div> is the spread parameter, whose optimal value is determined by minimizing the root mean square error (RMSE) between the training data and the predicted values of the dependent variable. 
   </p>
   <p xmlns="http://www.w3.org/1999/xhtml">The weight of the denominator neuron is set to 1.0. The GRNN training algorithm uses only one adjustable parameter 
    <div class="inline-formula">
     <div id="mm6" class="math">
      <div class="mrow">
       <span class="mi">σ</span>
      </div>
     </div>
    </div> for a given training set. Here we use “the holdout method” [
    <a rid="B29-sensors-19-01118" ref-type="bibr" href="#B29-sensors-19-01118">29</a>] to optimize the 
    <div class="inline-formula">
     <div id="mm7" class="math">
      <div class="mrow">
       <span class="mi">σ</span>
      </div>
     </div>
    </div> value, and detailed introduction can refer to the article [
    <a rid="B29-sensors-19-01118" ref-type="bibr" href="#B29-sensors-19-01118">29</a>]. The predicted target dependent variable, the ODIAC CO
    <sub>2</sub> emissions, is defined by the following Equation (3): 
    <div id="FD3-sensors-19-01118" class="disp-formula">
     <span class="label">(3)</span>
     <div id="mm8" class="math">
      <div class="mrow">
       <div class="mrow">
        <div accent="true" class="mover">
         <span class="mi">y</span>
         <span class="mo">^</span>
        </div>
        <div class="mrow">
         <span class="mo">(</span>
         <div class="mrow">
          <div class="msub">
           <span class="mi">x</span>
           <span class="mn">0</span>
          </div>
         </div>
         <span class="mo">)</span>
        </div>
        <span class="mo">=</span>
        <div class="mfrac">
         <div class="mrow">
          <div class="msubsup">
           <span class="mo">∑</span>
           <div class="mrow">
            <span class="mi">i</span>
            <span class="mo">=</span>
            <span class="mn">1</span>
           </div>
           <span class="mi">n</span>
          </div>
          <div class="msub">
           <span class="mi">y</span>
           <span class="mi">i</span>
          </div>
          <div class="msup">
           <span class="mi">e</span>
           <div class="mrow">
            <span class="mo">−</span>
            <span class="mi">d</span>
            <div class="mrow">
             <span class="mo">(</span>
             <div class="mrow">
              <div class="msub">
               <span class="mi">x</span>
               <span class="mn">0</span>
              </div>
              <span class="mo">,</span>
              <div class="msub">
               <span class="mi">x</span>
               <span class="mi">i</span>
              </div>
             </div>
             <span class="mo">)</span>
            </div>
           </div>
          </div>
         </div>
         <div class="mrow">
          <div class="msubsup">
           <span class="mo">∑</span>
           <div class="mrow">
            <span class="mi">i</span>
            <span class="mo">=</span>
            <span class="mn">1</span>
           </div>
           <span class="mi">n</span>
          </div>
          <div class="msup">
           <span class="mi">e</span>
           <div class="mrow">
            <span class="mo">−</span>
            <span class="mi">d</span>
            <div class="mrow">
             <span class="mo">(</span>
             <div class="mrow">
              <div class="msub">
               <span class="mi">x</span>
               <span class="mn">0</span>
              </div>
              <span class="mo">,</span>
              <div class="msub">
               <span class="mi">x</span>
               <span class="mi">i</span>
              </div>
             </div>
             <span class="mo">)</span>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>where the values calculated with the scalar function in a hidden neuron 
    <div class="inline-formula">
     <div id="mm9" class="math">
      <div class="mrow">
       <span class="mi">i</span>
      </div>
     </div>
    </div> are weighted with the corresponding values of the training samples 
    <div class="inline-formula">
     <div id="mm10" class="math">
      <div class="mrow">
       <div class="mrow">
        <div class="msub">
         <span class="mi">y</span>
         <span class="mi">i</span>
        </div>
       </div>
      </div>
     </div>
    </div>, and then passed to the numerator neuron. 
    <div class="inline-formula">
     <div id="mm11" class="math">
      <div class="mrow">
       <span class="mi">n</span>
      </div>
     </div>
    </div> is the number of training samples.
   </p>
  </sec>
 </sec>
</sec>
